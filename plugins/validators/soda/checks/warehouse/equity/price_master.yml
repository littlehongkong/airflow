checks for price_master:
  # ✅ 기본 품질 지표
  - row_count > 0

  # ✅ 결측값 검증
  - missing_count(ticker) = 0
  - missing_count(security_id) = 0
  - missing_count(date) = 0
  - missing_count(close) = 0
  - missing_count(source_vendor) = 0
  - missing_count(snapshot_date) = 0

  # ✅ 고유성 및 키 무결성 검증
  - duplicate_count(security_id) = 0
  - duplicate_count(ticker) = 0

  # ✅ 거래가격 논리 검증 (OHLC 관계)
  - failed rows:
      name: invalid_ohlc_logic
      fail condition: |
        (
          (high < low)
          OR (open > high)
        )
        AND NOT (
          (open = 0 AND high = 0 AND low = 0 AND close > 0)
        )



  # ✅ 거래량 음수 금지
  - failed rows:
      fail condition: volume < 0
      name: negative_volume

  # ✅ 시가총액 음수 금지
  - failed rows:
      fail condition: market_cap < 0
      name: negative_market_cap

  # ✅ Snapshot 메타데이터 검증
  - failed rows:
      fail condition: snapshot_date IS NULL OR source_vendor IS NULL
      name: missing_metadata

