checks for exchange_detail:
  # ✅ 데이터 존재
  - row_count > 0

  # ✅ 필수 필드
  - missing_count(Code) = 0
  - missing_count(Name) = 0

  # ✅ 선택 필드(국가, 통화, 시간대)는 일부 null 허용
  - missing_percent(Country) < 100
  - missing_percent(Currency) < 100
  - missing_percent(Timezone) < 100

  # ✅ 거래소 코드 형식 검증
  - failed rows:
      name: invalid_exchange_code_format
      fail condition: |
        NOT REGEXP_MATCHES(Code, '^[A-Z0-9]{1,10}$')

  # ✅ JSON 구조 검증
  - failed rows:
      name: invalid_json_structure
      fail condition: |
        (ExchangeHolidays IS NOT NULL AND NOT REGEXP_MATCHES(CAST(ExchangeHolidays AS VARCHAR), '^{.*}$'))
        OR
        (TradingHours IS NOT NULL AND NOT REGEXP_MATCHES(CAST(TradingHours AS VARCHAR), '^{.*}$'))
